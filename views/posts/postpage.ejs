<%- include("../partials/header.ejs") %>
<%- include("../partials/navbar.ejs") %> 

<h1> <%= post.title %> </h1>
<img src="<%=post.image%>" alt = "Project Image">
<h3>Created By: 
    <%if(post.User){ %>
        <%=post.User.username%><% } else { %> 
            A Former Creator
            <% } %>
</h3>
<form action='/posts/<%=post.id%>/like' method='POST'>
    <input type="submit" value="Like">
</form> 
Likes: <%=post.Like.length%>


<p> <%= post.content %> </p><br><br>

<form action='/posts/<%=post.id%>/comment' method='POST'>
    Comment Text: <input type="text" name="text">
    <input type="submit" value="Submit">
</form><br><br>

<ul>
    <% post.Comments.forEach(comment => { %>
        <%if(!comment.User) {%> 
            <li><%=comment.text%> -- A Former Creator </li> 
            <% } else { %>
            <li><%=comment.text%> -- <%=comment.User.username%> </li>
    <% }}) %>
</ul>
<% if(user) { %>
    <% if(post.userId === user.id) {%>
    <a href='/posts/<%=post.id%>/edit'>Edit Post</a><br>
    <form onsubmit = 'return confirm("Do you want to delete this post?")' action='/posts/<%=post.id%>?_method=DELETE' method='POST'>
        <input type="submit" value="Delete Post">
    </form>
<% }} %>

<%- include("../partials/footer.ejs") %>